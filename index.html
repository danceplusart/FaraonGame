<!DOCTYPE html>
<html lang="ru">
<head>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ö–∞–ª—å—è–Ω–Ω–∞—è –§–∞—Ä–∞–æ–Ω - –ü—Ä–æ–∫–ª—è—Ç–∏–µ</title>
    <style>
        /* –°—Ç–∏–ª–∏ –ø–æ–¥ –î—Ä–µ–≤–Ω–∏–π –ï–≥–∏–ø–µ—Ç */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Papyrus', 'Courier New', monospace;
        }

        body {
            background: linear-gradient(145deg, #1a0e0b 0%, #2c1a15 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 16px;
        }

        .game-container {
            max-width: 600px;
            width: 100%;
            background: #4a2e28;
            border: 4px solid #b88a3d;
            border-radius: 30px 30px 15px 15px;
            box-shadow: 0 20px 30px rgba(0,0,0,0.7), inset 0 0 20px #e6c27a;
            padding: 25px 20px;
            position: relative;
        }

        /* –î–µ–∫–æ—Ä–∞—Ç–∏–≤–Ω—ã–µ –∫–æ–ª–æ–Ω–Ω—ã */
        .game-container::before,
        .game-container::after {
            content: "ìÉÄ";
            font-size: 40px;
            color: #e6c27a;
            opacity: 0.2;
            position: absolute;
            top: 20px;
        }
        .game-container::before { left: 10px; }
        .game-container::after { right: 10px; }

        .title {
            text-align: center;
            font-size: 3rem;
            font-weight: bold;
            color: #f3d48b;
            text-shadow: 3px 3px 0 #7a4f2e, 5px 5px 0 #00000055;
            letter-spacing: 8px;
            margin-bottom: 15px;
            word-break: break-word;
        }

        .title span {
            font-size: 1.5rem;
            display: block;
            color: #c2a25b;
            text-shadow: 2px 2px 0 #3e2b1d;
        }

        /* –ë–ª–æ–∫ –∫–∞–ª—å—è–Ω–∞ */
        .hookah-area {
            background: #352016;
            border-radius: 80px 80px 40px 40px;
            padding: 30px 20px 20px 20px;
            border: 2px solid #b88a3d;
            box-shadow: inset 0 -10px 20px #1e110c;
            margin-bottom: 25px;
            position: relative;
        }

        .smoke-animation {
            display: flex;
            justify-content: center;
            gap: 10px;
            height: 80px;
            align-items: flex-end;
            margin-bottom: 20px;
        }

        .smoke-stack {
            width: 20px;
            background: #d9c8b2;
            border-radius: 20px 20px 0 0;
            transition: height 0.3s ease;
            box-shadow: 0 0 15px #ffebc0;
            opacity: 0.8;
        }

        /* –ö–æ–ª–±–∞ (–ø—Ä–æ–≥—Ä–µ—Å—Å –±–∞—Ä) */
        .pyramid-progress {
            text-align: center;
            margin: 20px 0;
            color: #f9e7b3;
        }

        .progress-bar-container {
            background: #2b1c14;
            height: 30px;
            border-radius: 30px;
            border: 2px solid #aa7c4f;
            overflow: hidden;
            margin-top: 5px;
            box-shadow: inset 0 2px 5px #00000099;
        }

        .progress-fill {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, #e0a82b, #f5d742, #ffec9e);
            box-shadow: 0 0 20px #ffbb2b;
            transition: width 0.4s ease;
        }

        /* –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ */
        .stats {
            display: flex;
            justify-content: space-between;
            background: #2f2019e0;
            border-radius: 50px;
            padding: 15px;
            border: 1px solid #c9a256;
            backdrop-filter: blur(2px);
            margin-bottom: 25px;
            color: #ffde9e;
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-size: 2.2rem;
            font-weight: bold;
            color: #ffd966;
            line-height: 1;
        }

        /* –ö–Ω–æ–ø–∫–∏ */
        .action-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-bottom: 30px;
        }

        .egypt-btn {
            background: #b58547;
            border: 3px solid #ffd78a;
            color: #281a0f;
            font-size: 1.8rem;
            font-weight: bold;
            padding: 15px 25px;
            border-radius: 60px 60px 20px 20px;
            box-shadow: 0 9px 0 #624a2e, 0 5px 15px #00000080;
            cursor: pointer;
            transition: 0.08s linear;
            text-transform: uppercase;
            letter-spacing: 2px;
            flex: 1;
            text-shadow: 1px 1px 0 #eec27e;
        }

        .egypt-btn:active {
            transform: translateY(7px);
            box-shadow: 0 2px 0 #4d3921, 0 5px 15px #00000080;
        }

        .egypt-btn:disabled {
            opacity: 0.5;
            transform: translateY(5px);
            box-shadow: 0 4px 0 #4d3921;
            pointer-events: none;
        }

        /* –ú–∏–Ω–∏-–∏–≥—Ä–∞ –°–∫–∞—Ä–∞–±–µ–π (—Å–ª–æ—Ç—ã) */
        .mini-game {
            background: #221712;
            border-radius: 30px;
            padding: 20px;
            border: 3px solid #dcb065;
        }

        .slots {
            display: flex;
            justify-content: space-around;
            gap: 10px;
            margin-bottom: 20px;
        }

        .slot-reel {
            background: #e8d6b5;
            width: 80px;
            height: 80px;
            border-radius: 20px 20px 10px 10px;
            border: 3px solid #a66f3f;
            box-shadow: inset 0 0 20px #8b6b41;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 4rem;
            color: #2f1b0e;
            text-shadow: 2px 2px 0 #b38b40;
            background: #f7e9cc;
            transition: 0.2s;
        }

        .spin-btn {
            background: #9f783e;
            border: 2px solid #fad47c;
            color: #1f1207;
            font-size: 1.5rem;
            padding: 10px;
            border-radius: 40px;
            width: 100%;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 5px 0 #594d32;
            transition: 0.08s;
        }

        .spin-btn:active {
            transform: translateY(5px);
            box-shadow: 0 0px 0 #594d32;
        }
        
        .game-message {
            text-align: center;
            margin-top: 15px;
            color: #f0cf8b;
            font-size: 1.2rem;
            min-height: 30px;
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="title">
            –§–ê–†–ê–û–ù ìÇÄ
            <span>–î—ã–º –ø—É—Å—Ç—ã–Ω–∏</span>
        </div>

        <!-- –ö–∞–ª—å—è–Ω —Å –∞–Ω–∏–º–∞—Ü–∏–µ–π –¥—ã–º–∞ (–ø—Å–µ–≤–¥–æ-–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä) -->
        <div class="hookah-area">
            <div class="smoke-animation" id="smokeAnimation">
                <div class="smoke-stack" id="smoke1" style="height: 20px;"></div>
                <div class="smoke-stack" id="smoke2" style="height: 45px;"></div>
                <div class="smoke-stack" id="smoke3" style="height: 70px;"></div>
                <div class="smoke-stack" id="smoke4" style="height: 35px;"></div>
                <div class="smoke-stack" id="smoke5" style="height: 55px;"></div>
            </div>
            <div style="text-align: center; color: #f3cf89;">ìÅπ –ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è –¥—ã–º–æ–º ìÅπ</div>
        </div>

        <!-- –ü—Ä–æ–≥—Ä–µ—Å—Å –ü–∏—Ä–∞–º–∏–¥–∞ -->
        <div class="pyramid-progress">
            <span>‚ö±Ô∏è –£—Ä–æ–≤–µ–Ω—å –¥—ã–º–∞ —Ñ–∞—Ä–∞–æ–Ω–∞ ‚ö±Ô∏è</span>
            <div class="progress-bar-container">
                <div class="progress-fill" id="progressFill" style="width: 0%;"></div>
            </div>
        </div>

        <!-- –°—á–µ—Ç—á–∏–∫–∏ -->
        <div class="stats">
            <div class="stat-item">
                <div>ìÜ£ –ó–∞—Ç—è–∂–µ–∫</div>
                <div class="stat-value" id="puffCount">0</div>
            </div>
            <div class="stat-item">
                <div>ìã¥ –°–≤–∏—Ç–∫–æ–≤</div>
                <div class="stat-value" id="scrollCount">0</div>
            </div>
        </div>

        <!-- –ì–ª–∞–≤–Ω—ã–µ –∫–Ω–æ–ø–∫–∏ -->
        <div class="action-buttons">
            <button class="egypt-btn" id="puffBtn">üí® –¢—è–≥–∞</button>
        </div>

        <!-- –ú–∏–Ω–∏-–∏–≥—Ä–∞: –°–æ–∫—Ä–æ–≤–∏—â–∞ –ï–≥–∏–ø—Ç–∞ (—Å–ª–æ—Ç—ã) -->
        <div class="mini-game">
            <div style="text-align: center; color: #f2d892; margin-bottom: 10px;">ìÄÄ –ó–∞–∫–ª–∏–Ω–∞–Ω–∏–µ –§–∞—Ä–∞–æ–Ω–∞ ìÄÄ</div>
            <div class="slots">
                <div class="slot-reel" id="reel1">ìÜ£</div>
                <div class="slot-reel" id="reel2">ìÜ£</div>
                <div class="slot-reel" id="reel3">ìÜ£</div>
            </div>
            <button class="spin-btn" id="spinBtn">üîÆ –ö—Ä—É—Ç–∏—Ç—å —Å–≤–∏—Ç–∫–∏ (1 —Å–≤–∏—Ç–æ–∫) üîÆ</button>
            <div class="game-message" id="gameMessage"></div>
        </div>
    </div>

    <script>
        (function() {
            // –ò–≥—Ä–æ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
            let puffs = 0;                // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞—Ç—è–∂–µ–∫
            let scrolls = 0;               // –°–≤–∏—Ç–∫–∏ (–≤–∞–ª—é—Ç–∞ –¥–ª—è –∏–≥—Ä—ã)
            let progress = 0;               // –ü—Ä–æ–≥—Ä–µ—Å—Å –¥–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ —Å–≤–∏—Ç–∫–∞ (max 100)
            
            // –°–∏–º–≤–æ–ª—ã –¥–ª—è —Å–ª–æ—Ç–æ–≤ (–µ–≥–∏–ø–µ—Ç—Å–∫–∏–µ —Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ)
            const symbols = ['ìÜ£', 'ìÅπ', 'ìã¥', 'ìÉÄ', 'ìäΩ']; // –°–∫–∞—Ä–∞–±–µ–π, –ì–ª–∞–∑, –°–≤–∏—Ç–æ–∫, –ó–º–µ—è, –ö–æ–ª–æ–Ω–Ω–∞

            // DOM —ç–ª–µ–º–µ–Ω—Ç—ã
            const puffCountEl = document.getElementById('puffCount');
            const scrollCountEl = document.getElementById('scrollCount');
            const progressFill = document.getElementById('progressFill');
            const puffBtn = document.getElementById('puffBtn');
            const spinBtn = document.getElementById('spinBtn');
            const reel1 = document.getElementById('reel1');
            const reel2 = document.getElementById('reel2');
            const reel3 = document.getElementById('reel3');
            const gameMessage = document.getElementById('gameMessage');
            
            // –≠–ª–µ–º–µ–Ω—Ç—ã –¥—ã–º–∞
            const smokeStacks = [
                document.getElementById('smoke1'),
                document.getElementById('smoke2'),
                document.getElementById('smoke3'),
                document.getElementById('smoke4'),
                document.getElementById('smoke5')
            ];

            // –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
            function updateUI() {
                puffCountEl.textContent = puffs;
                scrollCountEl.textContent = scrolls;
                progressFill.style.width = progress + '%';
                
                // –ê–Ω–∏–º–∞—Ü–∏—è –¥—ã–º–∞: —á–µ–º –±–æ–ª—å—à–µ –ø—Ä–æ–≥—Ä–µ—Å—Å, —Ç–µ–º –≤—ã—à–µ –¥—ã–º
                smokeStacks.forEach((stack, index) => {
                    let baseHeight = 20 + (index * 12); // –†–∞–∑–Ω–∞—è –≤—ã—Å–æ—Ç–∞ –¥–ª—è —Ä–µ–∞–ª–∏–∑–º–∞
                    let smokeIntensity = progress / 100; // 0 .. 1
                    let newHeight = Math.min(90, Math.floor(baseHeight + 40 * smokeIntensity));
                    stack.style.height = newHeight + 'px';
                    stack.style.background = `rgba(230, 210, 170, ${0.4 + smokeIntensity * 0.5})`;
                });
            }

            // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –æ—Ç –∑–∞—Ç—è–∂–∫–∏
            function addPuff() {
                puffs++;
                progress += 24; // –ö–∞–∂–¥–∞—è –∑–∞—Ç—è–∂–∫–∞ –¥–∞–µ—Ç 24% –ø—Ä–æ–≥—Ä–µ—Å—Å–∞

                // –ï—Å–ª–∏ –Ω–∞–∫–æ–ø–∏–ª 100+%, –ø–æ–ª—É—á–∞–µ–º —Å–≤–∏—Ç–æ–∫ –∏ —Å–±—Ä–∞—Å—ã–≤–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å —Å –æ—Å—Ç–∞—Ç–∫–æ–º
                if (progress >= 100) {
                    let earnedScrolls = Math.floor(progress / 100);
                    scrolls += earnedScrolls;
                    progress = progress % 100;
                    
                    gameMessage.textContent = `‚ö±Ô∏è –§–∞—Ä–∞–æ–Ω –¥–æ–≤–æ–ª–µ–Ω! +${earnedScrolls} —Å–≤–∏—Ç–æ–∫(–æ–≤)! ‚ö±Ô∏è`;
                } else {
                    gameMessage.textContent = '';
                }

                // –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –¥–æ 100 –¥–ª—è –ø–ª–∞–≤–Ω–æ—Å—Ç–∏ (–Ω–æ —É –Ω–∞—Å —Å–±—Ä–æ—Å –≤—ã—à–µ)
                if (progress > 100) progress = 100; 

                updateUI();
                
                // –≠—Ñ—Ñ–µ–∫—Ç —Ä—è–±–∏ –Ω–∞ –∫–Ω–æ–ø–∫–µ (—Ö–∞–ø—Ç–∏–∫-—Å—Ç–∏–ª—å)
                puffBtn.style.transform = 'scale(0.95)';
                setTimeout(() => puffBtn.style.transform = '', 100);
            }

            // –§—É–Ω–∫—Ü–∏—è –ø—Ä–æ–∫—Ä—É—Ç–∫–∏ —Å–ª–æ—Ç–æ–≤ (–º–∏–Ω–∏-–∏–≥—Ä–∞)
            function spinSlots() {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Ö–≤–∞—Ç–∞–µ—Ç –ª–∏ —Å–≤–∏—Ç–∫–æ–≤
                if (scrolls < 1) {
                    gameMessage.textContent = 'ìÄê –ù—É–∂–µ–Ω 1 —Å–≤–∏—Ç–æ–∫! –°–¥–µ–ª–∞–π –∑–∞—Ç—è–∂–∫—É.';
                    return;
                }

                // –¢—Ä–∞—Ç–∏–º —Å–≤–∏—Ç–æ–∫
                scrolls--;
                updateUI();

                // –≠—Ñ—Ñ–µ–∫—Ç –ø—Ä–æ–∫—Ä—É—Ç–∫–∏ (—Å–ª—É—á–∞–π–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã 3 —Ä–∞–∑–∞)
                let spinsLeft = 3;
                let spinInterval = setInterval(() => {
                    reel1.textContent = symbols[Math.floor(Math.random() * symbols.length)];
                    reel2.textContent = symbols[Math.floor(Math.random() * symbols.length)];
                    reel3.textContent = symbols[Math.floor(Math.random() * symbols.length)];
                    spinsLeft--;
                    if (spinsLeft === 0) clearInterval(spinInterval);
                }, 100);

                // –§–∏–Ω–∞–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç —á–µ—Ä–µ–∑ 400ms
                setTimeout(() => {
                    // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Ñ–∏–Ω–∞–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã
                    const final1 = symbols[Math.floor(Math.random() * symbols.length)];
                    const final2 = symbols[Math.floor(Math.random() * symbols.length)];
                    const final3 = symbols[Math.floor(Math.random() * symbols.length)];
                    
                    reel1.textContent = final1;
                    reel2.textContent = final2;
                    reel3.textContent = final3;

                    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—ã–∏–≥—Ä—ã—à–∞ (–≤—Å–µ —Ç—Ä–∏ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ)
                    if (final1 === final2 && final2 === final3) {
                        // –ë–æ–Ω—É—Å: –¥–æ–±–∞–≤–ª—è–µ–º —Å–≤–∏—Ç–∫–∏
                        let bonus = 5;
                        scrolls += bonus;
                        gameMessage.textContent = `ìéõ –ë–ª–∞–≥–æ—Å–ª–æ–≤–µ–Ω–∏–µ –†–∞! +${bonus} —Å–≤–∏—Ç–∫–æ–≤! ìéõ`;
                    } else if (final1 === final2 || final2 === final3 || final1 === final3) {
                        // –£—Ç–µ—à–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–∏–∑
                        scrolls += 1;
                        gameMessage.textContent = 'ìÇÄ –î–≤–∞ –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö! +1 —Å–≤–∏—Ç–æ–∫.';
                    } else {
                        gameMessage.textContent = 'ìÑÄ –ù–∏—á–µ–≥–æ... –ü–æ–ø—Ä–æ–±—É–π –µ—â–µ.';
                    }
                    
                    updateUI();
                }, 400);
            }

            // –°–ª—É—á–∞–π–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –≤—ã—Å–æ—Ç—ã –¥—ã–º–∞ –¥–ª—è —Ä–µ–∞–ª–∏–∑–º–∞ (–ø–∞—Å—Å–∏–≤–Ω–æ–µ)
            function animatePassiveSmoke() {
                if (progress < 5) return; // –µ—Å–ª–∏ –º–∞–ª–æ –¥—ã–º–∞, –Ω–µ —à–µ–≤–µ–ª–∏–º
                smokeStacks.forEach((stack) => {
                    let currentHeight = parseInt(stack.style.height) || 30;
                    let variation = Math.random() * 10 - 5; // -5 –¥–æ +5
                    let newHeight = Math.min(120, Math.max(15, currentHeight + variation));
                    stack.style.height = newHeight + 'px';
                });
            }

            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
            puffBtn.addEventListener('click', addPuff);
            spinBtn.addEventListener('click', spinSlots);

            // –ü–∞—Å—Å–∏–≤–Ω–∞—è –∞–Ω–∏–º–∞—Ü–∏—è –¥—ã–º–∞ (–¥—ã–º "–¥—ã—à–∏—Ç")
            setInterval(animatePassiveSmoke, 500);

            // –ù–∞—á–∞–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI
            updateUI();

            // –î–æ–±–∞–≤–∏–º –ø–∞—Ä—É —Å—Ç–∞—Ä—Ç–æ–≤—ã—Ö —Å–≤–∏—Ç–∫–æ–≤ –¥–ª—è —Ç–µ—Å—Ç–∞
            scrolls = 3;
            updateUI();
        })();
    </script>
</body>
</html>